# 告警抑制规则配置指南

## 🔧 抑制规则设置方法

### 在前端界面设置
1. 进入 **告警规则管理** 页面
2. 点击 **新增规则** 或编辑现有规则
3. 在表单中设置：
   - **抑制条件**: 如 `5m`（5分钟内只发一次）
   - **再通知间隔**: 如 `1800`（1800秒 = 30分钟重复一次）

### 📊 常见配置示例

#### 1. CPU使用率告警（严重级别）
```
规则名称: 系统CPU使用率告警
PromQL: 100 - (avg(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)
告警条件: > 90
告警等级: critical
抑制条件: 5m     # 5分钟内不重复
再通知间隔: 1800  # 30分钟后重复通知
```

#### 2. 内存使用率告警（高级别）
```
规则名称: 系统内存使用率告警
PromQL: (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100
告警条件: > 85
告警等级: high
抑制条件: 10m    # 10分钟内不重复
再通知间隔: 3600  # 1小时后重复通知
```

#### 3. 磁盘空间告警（严重级别）
```
规则名称: 磁盘空间不足告警
PromQL: (1 - (node_filesystem_avail_bytes / node_filesystem_size_bytes)) * 100
告警条件: > 90
告警等级: critical
抑制条件: 2m     # 2分钟内不重复
再通知间隔: 900   # 15分钟后重复通知
```

#### 4. HDFS存储告警（高级别）
```
规则名称: HDFS存储使用率告警
PromQL: hdfs_capacity_used_percent
告警条件: > 80
告警等级: high
抑制条件: 15m    # 15分钟内不重复
再通知间隔: 7200  # 2小时后重复通知
```

### ⏰ 抑制时间格式说明
- `30s` - 30秒
- `5m` - 5分钟
- `1h` - 1小时
- `2d` - 2天

### 🎯 推荐配置标准

| 告警等级 | 抑制条件 | 再通知间隔 | 说明 |
|---------|---------|-----------|------|
| critical | 1m-5m | 300-900秒 | 严重告警，快速响应 |
| high | 5m-15m | 1800-3600秒 | 高级告警，及时处理 |
| medium | 15m-30m | 3600-7200秒 | 中级告警，定期关注 |
| low | 30m-1h | 7200-14400秒 | 低级告警，常规监控 |

### 🔄 告警状态流转
```
正常(ok) → 告警(alerting) → 静默(silenced) → 告警(alerting)
```

### 💡 最佳实践
1. **避免告警风暴**: 设置合理的抑制时间
2. **重要告警及时响应**: 严重告警的抑制时间不要太长
3. **考虑业务影响**: 根据服务重要性调整抑制策略
4. **定期审查**: 根据实际情况调整抑制规则

### 🛠️ 测试抑制规则
可以使用告警引擎的测试功能验证抑制效果：
1. 手动触发告警检测
2. 观察告警状态变化
3. 检查告警历史记录
